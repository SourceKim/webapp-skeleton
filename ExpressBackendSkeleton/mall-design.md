# 简介

# 实体

### 商品模块

#### 1. 商品分类表 `mall_product_category`

| 字段名      | 类型   | 数据库类型  | 可否为空 | 外键 | 描述     | 示例数据     |
| ------------- | -------- | ------------- | ---------- | ------ | ---------- | -------------- |
| name        | string | VARCHAR(50) | 否       |      | 分类名称 | 电子产品     |
| description | string | TEXT        | 是       |      | 分类描述 | 手机、电脑等 |

---

#### 2. 商品表 `mall_product`

| 字段名          | 类型   | 数据库类型    | 可否为空 | 外键                              | 描述                                 | 示例数据   |
| ----------------- | -------- | --------------- | ---------- | ----------------------------------- | -------------------------------------- | ------------ |
| name            | string | VARCHAR(100)  | 否       |                                   | 商品名称                             | iPhone 15  |
| description     | string | TEXT          | 是       |                                   | 商品描述                             | 最新款手机 |
| price           | number | DECIMAL(10,2) | 否       |                                   | 商品价格                             | 6999.00    |
| stock           | number | INT           | 否       |                                   | 库存数量                             | 100        |
| status          | enum   | ENUM          | 否       |                                   | 状态：`active`（上架）/ `inactive`（下架）             | active     |
| category\_id | number | INT           | 是       | mall\_product\_category(id) | 所属分类                             | 1          |
| materials       | 数组   |               |          | <br />                                | 关联 material 表，可能是视频、图片等 |            |

---

### 订单模块

#### 1. 订单表 `mall_order`

| 字段名           | 类型   | 数据库类型    | 可否为空 | 外键     | 描述                                                                         | 示例数据           |
| ------------------ | -------- | --------------- | ---------- | ---------- | ------------------------------------------------------------------------------ | -------------------- |
| order\_number | string | VARCHAR(36)   | 否       |          | 唯一订单号（建议 UUID）                                                      | "a1b2c3d4-e5f6..." |
| remark           | string | TEXT          | 是       |          | 订单备注                                                                     | 请尽快发货         |
| user\_id      | number | INT           | 否       | user(id) | 关联用户                                                                     | 123                |
| total\_price  | number | DECIMAL(10,2) | 否       |          | 订单总金额                                                                   | 13998.00           |
| status           | enum   | ENUM          | 否       |          | 状态：`pending`（待支付）、`paid`（已支付）、`shipped`（已发货）、`completed`（已完成）、`refunding`（待退款）、`refunded`（已退款） | paid               |

---

#### 2. 订单项表 `mall_order_item`

| 字段名         | 类型   | 数据库类型    | 可否为空 | 外键                 | 描述             | 示例数据 |
| ---------------- | -------- | --------------- | ---------- | ---------------------- | ------------------ | ---------- |
| product\_id | number | INT           | 否       | mall\_product(id) | 关联商品         | 1        |
| order\_id   | number | INT           | 否       | mall\_order(id)   | 关联订单         | 1        |
| quantity       | number | INT           | 否       |                      | 购买数量         | 2        |
| price          | number | DECIMAL(10,2) | 否       |                      | 下单时的商品单价 | 6999.00  |

---

### 购物车模块

#### 1. 购物车表 `mall_cart`

| 字段名          | 类型   | 数据库类型    | 可否为空 | 外键     | 描述         | 示例数据 |
| ----------------- | -------- | --------------- | ---------- | ---------- | -------------- | ---------- |
| user\_id     | number | INT           | 否       | user(id) | 关联用户     | 123      |
| total\_price | number | DECIMAL(10,2) | 否       |          | 购物车总金额 | 13998.00 |

---

#### 2. 购物车项表 `mall_cart_item`

| 字段名         | 类型   | 数据库类型 | 可否为空 | 外键                 | 描述       | 示例数据 |
| ---------------- | -------- | ------------ | ---------- | ---------------------- | ------------ | ---------- |
| product\_id | number | INT        | 否       | mall\_product(id) | 关联商品   | 1        |
| cart\_id    | number | INT        | 否       | mall\_cart(id)    | 关联购物车 | 1        |
| quantity       | number | INT        | 否       |                      | 商品数量   | 2        |

---

# 路由

### 商品模块 (Product)

#### **用户端 API**

| 路由路径 | 方法 | 描述                         | 权限     |
| ---------- | ------ | ------------------------------ | ---------- |
| `/api/user/products`         | GET  | 获取商品列表（带分页和过滤） | 普通用户 |
| `/api/user/products/:id`         | GET  | 获取单个商品详情             | 普通用户 |
| `/api/user/categories`         | GET  | 获取所有商品分类             | 普通用户 |

#### **管理端 API**

| 路由路径 | 方法   | 描述                       | 权限   |
| ---------- | -------- | ---------------------------- | -------- |
| `/api/admin/products`         | POST   | 创建新商品                 | 管理员 |
| `/api/admin/products/:id`         | PUT    | 更新商品信息               | 管理员 |
| `/api/admin/products/:id`         | DELETE | 删除商品（软删除）         | 管理员 |
| `/api/admin/categories`         | POST   | 创建商品分类               | 管理员 |
| `/api/admin/categories/:id`         | PUT    | 更新商品分类               | 管理员 |
| `/api/admin/categories/:id`         | DELETE | 删除分类（关联商品需处理） | 管理员 |

---

### 购物车模块 (Cart)

#### **用户端 API**

| 路由路径 | 方法   | 描述                 | 权限     |
| ---------- | -------- | ---------------------- | ---------- |
| `/api/user/cart`         | GET    | 获取当前用户的购物车 | 普通用户 |
| `/api/user/cart/items`         | POST   | 添加商品到购物车     | 普通用户 |
| `/api/user/cart/items/:id`         | PUT    | 修改购物车项数量     | 普通用户 |
| `/api/user/cart/items/:id`         | DELETE | 移除购物车项         | 普通用户 |
| `/api/user/cart/clear`         | POST   | 清空购物车           | 普通用户 |

#### **管理端 API**

*通常购物车无需管理端操作，若需审计可扩展：*

| 路由路径 | 方法 | 描述                 | 权限   |
| ---------- | ------ | ---------------------- | -------- |
| `/api/admin/carts`         | GET  | 查询所有用户的购物车 | 管理员 |

---

### 订单模块 (Order)

#### **用户端 API**

| 路由路径 | 方法 | 描述                       | 权限     |
| ---------- | ------ | ---------------------------- | ---------- |
| `/api/user/orders`         | POST | 创建订单（从购物车生成）   | 普通用户 |
| `/api/user/orders`         | GET  | 获取用户的所有订单         | 普通用户 |
| `/api/user/orders/:id`         | GET  | 获取订单详情               | 普通用户 |
| `/api/user/orders/:id/cancel`         | POST | 取消订单（仅限未支付状态） | 普通用户 |

#### **管理端 API**

| 路由路径 | 方法 | 描述                         | 权限   |
| ---------- | ------ | ------------------------------ | -------- |
| `/api/admin/orders`         | GET  | 获取所有订单（带过滤条件）   | 管理员 |
| `/api/admin/orders/:id`         | PUT  | 更新订单状态（如发货、退款） | 管理员 |
| `/api/admin/orders/stats`         | GET  | 获取订单统计信息             | 管理员 |

---

---

###